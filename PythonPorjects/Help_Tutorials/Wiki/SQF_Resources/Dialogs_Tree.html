<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Dialogs Tree - VBS Scripting Reference</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="1513356">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">SQF</span>
                    <img class="space-logo" src="SQF.png" />
                </h1>
                <a href="VBS_Scripting_Reference.html" class="ht-space-link">
                    <h2>VBS Scripting Reference</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=1508586"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="VBS_Scripting_Reference.html">VBS Scripting Reference</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Scripting_References.html">Scripting References</a></li>
                                                                                     <li><a href="VBS_Dialogs.html">VBS Dialogs</a></li>
                                                            </ul>
</div>            <h1 id="src-1508586"> <span>Dialogs Tree</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <div class="section section-1" id="src-1508586_DialogsTree-Introduction">
        <h1 class="heading "><span>Introduction</span></h1>
<img  class="confluence-embedded-image"  src="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829714-api-v2.gif" alt="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829714-api-v2.gif"   />
    <p   
>Tree controls are used to display hierarchical structures, with collapsible branches and multiple columns.<br/>While engine-controlled trees have always been available in VBS (type 12), only since V3.4 can they also be created by users. The new style of trees is referred to as &quot;advanced trees&quot; (type 107), and all documentation in the article below applies to this new control type.</p>
<p   
><strong class=" ">Related commands:</strong> <a   href="Interactions_-_User_Dialogs_-_Trees.html">Interactions - User Dialogs - Trees</a></p>
<p   
><strong class=" ">Demo mission:</strong> <a   href="attachments/1514436_2_Dialog_Tree.zip">Dialog Tree.zip</a></p>
    </div>
    <div class="section section-1" id="src-1508586_DialogsTree-Structure">
        <h1 class="heading "><span>Structure</span></h1>
<p   
>A tree control consists of a number of rows, each of which represents one &quot;branch&quot;.<br/>Each branch (whether it&#39;s a top-level branch or already a sub-branch) can itself contain other sub-branches.</p>
<p   
>Each row can have multiple columns. The number of columns is <i class=" ">not</i> defined in the dialog&#39;s configuration itself, but depends on how many elements are passed when the branch is <a   href="advTreeAdd.html">advTreeAdd</a> or <a   href="advTreeSetText.html">advTreeSetText</a>.</p>
<p   
>Rows and columns can be deleted while the dialog is open, and the content following the deleted space will shift up or left to fill the gap. While it is not possible to <i class=" ">insert</i> rows or columns, new data can be added at run-time, and through re-arrangements an insertion could be simulated.</p>
<p   
>The branches are referred to via an index number (which is generated when the branch is <a   href="advTreeAdd.html">advTreeAdd</a>. This index number may correlate with the physical row number of the specific branch, but this is not necessarily so, since the index numbers are created sequentially, and if I first create branch 1,2 &amp; 3, and then add a sub-branch to 2, then its index will be 4.</p>
    </div>
    <div class="section section-1" id="src-1508586_DialogsTree-Content">
        <h1 class="heading "><span>Content</span></h1>
<p   
>Any text displayed in a tree control is <a   href="Structured_Text.html">Structured_Text</a>. This allows the use of different colors, sizes, and even images.<br/>Currently only PAA images can be displayed, and only its alpha channel is shown (as a silhouette).</p>
    </div>
    <div class="section section-1" id="src-1508586_DialogsTree-Usage">
        <h1 class="heading "><span>Usage</span></h1>
    <div class="section section-2" id="src-1508586_DialogsTree-Rows">
        <h2 class="heading "><span>Rows</span></h2>
<img  class="confluence-embedded-image"  src="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829939-api-v2.jpg" alt="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829939-api-v2.jpg"   />
    <p   
>To add a new top-level branch/row to the control, <a   href="advTreeAdd.html">advTreeAdd</a> is called with an index of 0:</p>
<pre class=" ">_trunk = _treeCtrl advTreeAdd [0,&quot;Animals&quot;];</pre><p   
>This returns the index of the created branch (in case of the first entry, this would be 1).<br/>To then add a <i class=" ">sub-branch</i>, the index of that first branch is used as the index for the next <a   href="advTreeAdd.html">advTreeAdd</a> calls:</p>
<pre class=" ">_treeCtrl advTreeAdd [_trunk,&quot;Camel&quot;];<br/>_treeCtrl advTreeAdd [_trunk,&quot;Cow&quot;];</pre><img  class="confluence-embedded-image"  src="images/download/attachments/1507348/Dialog_Tree_Two-version-2-modificationdate-1505466836223-api-v2.gif" alt="images/download/attachments/1507348/Dialog_Tree_Two-version-2-modificationdate-1505466836223-api-v2.gif"   />
    <p   
>To add <i class=" ">another</i> top-level entry, <a   href="advTreeAdd.html">advTreeAdd</a> is called once more, again with an index of 0:</p>
<pre class=" ">_trunk = _treeCtrl advTreeAdd [0,&quot;Humans&quot;];</pre><p   
>The returned index (which is now 6: five existing rows, plus the newly created one) is then used to add more sub-branches:</p>
<pre class=" ">_treeCtrl advTreeAdd [_trunk,&quot;Civilian&quot;];<br/>_treeCtrl advTreeAdd [_trunk,&quot;East&quot;];</pre><p   
><br/></p>
    </div>
    <div class="section section-2" id="src-1508586_DialogsTree-Columns">
        <h2 class="heading "><span>Columns</span></h2>
<p   
>Each row can have multiple columns, to display text (the branching always happens in the first column).<br/>Method 1: When the branch is created (via <a   href="advTreeAdd.html">advTreeAdd</a>), instead of a string an array is passed (with one text element per column). This works for top-level, as well as sub branches:</p>
<img  class="confluence-embedded-image"  src="images/download/attachments/1507348/Dialog_Tree_Columns-version-2-modificationdate-1505466835904-api-v2.gif" alt="images/download/attachments/1507348/Dialog_Tree_Columns-version-2-modificationdate-1505466835904-api-v2.gif"   />
    <pre class=" ">_trunk = _treeCtrl advTreeAdd [0,[&quot;Animals&quot;,&quot;Health&quot;,&quot;Location&quot;]];<br/>_treeCtrl advTreeAdd [_trunk,[&quot;Camel&quot;,str _health,_pos]];</pre><p   
>The second method (which also allows the modification of existing rows) uses the <a   href="advTreeSetText.html">advTreeSetText</a> command, to set the content of a specific column for the selected row (the row count is zero-based, i.e. the index for the leftmost column is 0). If only a string is passed (instead of an array), the data will be put into the first column.</p>
<pre class=" ">_branch = _treeCtrl advTreeAdd [_trunk,&quot;&quot;];          // create an empty sub branch<br/>_treeCtrl advTreeSetText [_branch, &quot;Cow&quot;];           // put &quot;Cow&quot; into the 1st column<br/>_treeCtrl advTreeSetText [_branch, [1,str _health]]; // put the health number into the 2nd<br/>_treeCtrl advTreeSetText [_branch, [2,_pos]];        // and the position into the 3rd</pre>    </div>
    </div>
    <div class="section section-1" id="src-1508586_DialogsTree-Properties">
        <h1 class="heading "><span>Properties</span></h1>
<p   
><i class=" ">Only properties unique to this control type are listed. For general properties, see the <a   href="VBS_Displays.html#src-1509011_VBSDisplays-Properties">Properties</a> page.</i><br/>(A definition for <a   href="Dialogs_Scrollbars.html">Dialogs_Scrollbars</a> must be included in the tree&#39;s control class.)</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                                    <col />
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Name</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Type</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Required</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Remark</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Script</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">type</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Number.html#src-1508426_Number-Integer">Integer</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Control type: 107 (or CT_ADV_TREE, if using constants)</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">style</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Number.html#src-1508426_Number-Integer">Integer</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Display options:</p>
<ul class=" "><li class=" "><p   
>0 : Regular tree</p>
</li><li class=" "><p   
>2 (TR_AUTOCOLLAPSE): If one branch is expanded, other, already expanded branches will be closed.</p>
</li><li class=" "><p   
>224 (ST_DYNAMIC_HEIGHT): Height is adjusted automatically, to contain all lines.</p>
</li></ul><p   
><br/>Multiple style options can be combined by adding them, e.g.<br/>style= ST_RIGHT + ST_MULTI</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">defaultColumnWidth</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Number.html#src-1508426_Number-Float">Float</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Default width of each column.<br/>Default: 0.05</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="advTreeItemSetColumnSize.html">advTreeItemSetColumnSize</a></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowHeight</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Number.html#src-1508426_Number-Float">Float</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Height of each row. This property <i class=" ">only</i> defines the space a row will take up, but not how much of it is usable - that is done via &#39;sizeEx&#39;. e.g. if &#39;rowHeight&#39; is set to 0.1, but &#39;sizeEx&#39; is set to 0.02, then a doubling of the text size (via the <a   href="Structured_Text.html#src-1508210_Structured_Text-size">size</a> will result in truncated letters, even though the overall space would be adequate.<br/>Default: Roughly 110% of &#39;sizeEx&#39; definition.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">colorText</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Color of lines that connect branches.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">colorBackground</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Background color. Solid color filling the whole control area.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">colorBorder</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Color of border drawn around the whole control.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorBackground1</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Background color of odd lines (line 1,3,etc.).</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorBackgroundSelected1</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Background color of odd lines, when they have focus.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorText1</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Text color for odd lines.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorTextSelected1</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Text color for odd lines, when they have focus.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorBackground2</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Background color of even lines (line 2,4,etc.).</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorBackgroundSelected2</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Background color of even lines, when they have focus.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorText2</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Text color for even lines.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">rowColorTextSelected2</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Yes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Text color for even lines, when they have focus.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">iconExpand</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="String.html">String</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Path to image (PAA) that should be shown when a branch has been expanded. Default: minus sign</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">iconExpandColor</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Color of image &#39;iconExpand&#39;.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">iconCollapse</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="String.html">String</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Path to image (PAA) that should be shown when a branch has been collapsed. Default: plus sign</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><strong class=" ">iconCollapseColor</strong></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><a   href="Color.html">Color</a></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>No</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Color of image &#39;iconCollapse&#39;.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>n/a</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
><br/></p>
    </div>
    <div class="section section-1" id="src-1508586_DialogsTree-EventHandlers">
        <h1 class="heading "><span>Event Handlers</span></h1>
<p   
>Several event handlers can be assigned to buttons. Check <a   href="VBS_User_Interface_Event_Handlers.html#src-1509050_VBSUserInterfaceEventHandlers-ReferenceListUser">Reference ListUser</a> for details (if the column &quot;scope&quot; contains a &quot;Tr&quot;, then that respective event can be used with tree controls).</p>
    </div>
    <div class="section section-1" id="src-1508586_DialogsTree-Examples">
        <h1 class="heading "><span>Examples</span></h1>
<p   
>The mission <a   href="attachments/1514436_2_Dialog_Tree.zip">Dialog Tree.zip</a> contains a demonstration of the examples shown below.</p>
    <div class="section section-2" id="src-1508586_DialogsTree-TreeControlDefinition">
        <h2 class="heading "><span>Tree Control Definition</span></h2>
<p   
>All of the examples use the same dialog definition. The number of columns (and their widths) are defined by the scripts that populate the tree control.</p>
<pre class=" ">class DlgTree {<br/>  idd = 20000;<br/>  movingEnable = true;<br/><br/>  class controls {<br/>    class Tree {<br/>      idc = 20000; <br/>      type = 107; // CT_ADV_TREE<br/>      style = 0;  // TR_AUTOCOLLAPSE:2 | ST_DYNAMIC_HEIGHT:224<br/><br/>      x = 0.1; y = 0.3;<br/>      w = 0.8; h = 0.4;<br/><br/>      sizeEx = .026; // font size (and usable column height)<br/>      font = &quot;TahomaB&quot;;<br/><br/>      colorText[] = {0, 0, 0, 1}; // connection line color <br/>      colorBorder[] = {0, 0, 0, 1}; <br/>      colorBackground[] = {0.2, 0.2, 0.2, 1};<br/>      <br/>      // odd rows<br/>      rowColorBackground1[] = {0.7, 0.7, 0.7, 1};<br/>      rowColorBackgroundSelected1[] = {1, 0.8, 0.3, 1};<br/>      rowColorText1[] = {0, 0, 0, 1};<br/>      rowColorTextSelected1[] = {0, 0, 0, 1};<br/>      // even rows<br/>      rowColorBackground2[] = {0.8, 0.8, 0.8, 1};<br/>      rowColorBackgroundSelected2[] = {1, 0.8, 0.3, 1};<br/>      rowColorText2[] = {0, 0, 0, 1};<br/>      rowColorTextSelected2[] = {0, 0, 0, 1};<br/>      <br/>      class VScrollbar {<br/>        color[]               = {1, 1, 1, 1};<br/>        width                 = 0.021;<br/>        autoScrollSpeed       = -1;<br/>        autoScrollDelay       = 5;<br/>        autoScrollRewind      = false;<br/>        shadow                = 0;<br/>      };<br/>      class HScrollbar : VScrollbar {<br/>        height                = 0.028;<br/>      };<br/>    };<br/>  };<br/>};</pre>    </div>
    <div class="section section-2" id="src-1508586_safe-id-RGlhbG9nc1RyZWUtU2luZ2xlLGJyYW5jaGVkdHJlZQ">
        <h2 class="heading "><span>Single, branched tree</span></h2>
<img  class="confluence-embedded-image"  src="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829939-api-v2.jpg" alt="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829939-api-v2.jpg"   />
    <p   
><tt class=" ">// create dialog, and get tree control createDialog &quot;DlgTree&quot;; waitUntil {dialog}; _treeCtrl = findDisplay 20000 displayCtrl 20000; // adjust the column widths _treeCtrl advTreeItemSetColumnSize [0, .13]; _treeCtrl advTreeItemSetColumnSize [1, .08]; // create the top-level (header) row _trunk = _treeCtrl advTreeAdd [0,[&quot;Animals&quot;,&quot;Health&quot;,&quot;Location&quot;]]; // find all animals in mission { if (_x isKindOf &quot;vbs2_animal_base&quot;) then { // add one row per animal, with data for 3 columns (name, health, position) _treeCtrl advTreeAdd [_trunk,[str _x,str(1-(getDammage _x),positionToGrid (getPos _x)]]; }; }forEach allUnits; // display the tree in expanded mode _treeCtrl advTreeExpand 1;</tt></p>
    </div>
    <div class="section section-2" id="src-1508586_safe-id-RGlhbG9nc1RyZWUtTXVsdGlwbGUsbmVzdGVkYnJhY2hlcw">
        <h2 class="heading "><span>Multiple, nested braches</span></h2>
<img  class="confluence-embedded-image"  src="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829714-api-v2.gif" alt="images/download/attachments/1507348/Dialog_Control_AdvTree-version-2-modificationdate-1505466829714-api-v2.gif"   />
    <p   
>This example uses custom expand/collapse icons, defined as an alternative control class, which inherits all other properties from the &#39;Tree&#39; class defined above: <tt class=" ">// description.exe class Tree2 : Tree { idc = 20001; iconExpand = &quot;\vbs2\ui\data\vbs3_unlocked_ca.paa&quot;; iconExpandColor[] = {0.4, 0.4, 0.4, 1}; iconCollapse = &quot;\vbs2\ui\data\vbs3_lock_ca.paa&quot;; iconCollapseColor[] = {0.3, 0.3, 0.3, 1}; };</tt></p>
<p   
><tt class=" ">// create dialog, and get tree control createDialog &quot;DlgTree&quot;; waitUntil {dialog}; _treeCtrl = findDisplay 20000 displayCtrl 20001; // create the top-level (header) row _trunk = _treeCtrl advTreeAdd [0,&quot;Troop Strengths&quot;]; { // go through both sides _side = _x; create a sub-branch for each side _sideBranch = _treeCtrl advTreeAdd [0,str _side]; { // go through all groups _grp = _x; if (side leader _x==_side) then { create another sub-branch under the side branch for each groups _grpBranch = _treeCtrl advTreeAdd [_sideBranch,str _grp]; // populate the group branch with position information for the leader _pos = positionToGrid (getPos leader _grp); _treeCtrl advTreeSetText [_grpBranch, [1,format[&quot;Position: %1&quot;,_pos]]]; _vehicles = []; { _veh = vehicle _x; if !(_veh in _vehicles) then { _vehicles = _vehicles + [_veh]; // for each infantry unit or vehicle add one row _dName = getText(configFile&gt;&gt;&quot;cfgVehicles&quot;&gt;&gt;typeOf _veh&gt;&gt;&quot;displayName&quot;); _pic = previewPicture (typeOf _veh); _unitBranch = _treeCtrl advTreeAdd [_grpBranch,[_dName,format[&quot;&lt;img image=&#39;%1&#39; /&gt;&quot;,_pic]]]; }; }forEach (units _grp); }; }forEach allGroups; }forEach [west,east];</tt></p>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Dialogs_Toolbox.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Dialogs Toolbox</span>
        </a>
                <a href="HTML_file.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>HTML file</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
